# 说明

小程序 WiFi 配网。

# BLE 定义

## 广播

广播名称必须带有 `"lr_wificfg-"` 前缀。

## 服务

|      | UUID                                                                  | 功能          |
| ---- | --------------------------------------------------------------------- | ------------- |
| 服务 | 16bit : `0xFDD0`  <br>128bit : `0000FDD0-0000-1000-8000-00805f9b34fb` |               |
| 特性 | 16bit : `0xFDD1`  <br>128bit : `0000FDD1-0000-1000-8000-00805f9b34fb` | write |
| 特性 | 16bit : `0xFDD2`  <br>128bit : `0000FDD1-0000-1000-8000-00805f9b34fb` | notify |


## 通信规则

- 每个指令超时为 10 秒。
- 连接间隔应小于等于 150 ms。

# 协议格式

| header  |  cmd | payload  |
| ------------ | ------------ | ------------ |
| 0x58 0x5A  | 0x00 - 0xff  |  n |

## 获取当前 WiFi 配置：0x00

设备的 WiFi 配置： ssid = "chinanet"，password = "12345678"

### 小程序 -> 设备

| header  |  cmd |  payload  |
| ------------ | ------------ | ------------ |
| 0x58 0x5A  | 0x00  |  --- |

### 设备 -> 小程序

| header  |  cmd |  payload |
| ------------ | ------------ | ------------ |
| 0x58 0x5A  | 0x00  |  8 (len of ssid) + chinanet + 8 (len of password) + password |

## 修改 WiFi 配置：0x01

修改设备的 WiFi 配置为： ssid = "chinanet"，password = "12345678"

### 小程序 -> 设备

| header  |  cmd |  payload  |
| ------------ | ------------ | ------------ |
| 0x58 0x5A  | 0x01  |  8 (len of ssid) + chinanet + 8 (len of password) + password  |

### 设备 -> 小程序

| header    | cmd | payload                                   |
| --------- | --- | ----------------------------------------- |
| 0x58 0x5A | 0x01   | 1 byte resp ：0，success；others，error。 |

## 获取 WiFi 扫描列表：0x02

### 小程序 -> 设备

| header  |  cmd |  payload  |
| ------------ | ------------ | ------------ |
| 0x58 0x5A  | 0x02 |  --- |

### 设备 -> 小程序

| header    | cmd  | payload                              |
| --------- | ---- | ------------------------------------ |
| 0x58 0x5A | 0x02 | ap_nums + len of 1st + 1st ssid name .... |


> 扫描到的 ap 太多，可分可多次回复。
> 最后以 58 5A 02 00 结束。